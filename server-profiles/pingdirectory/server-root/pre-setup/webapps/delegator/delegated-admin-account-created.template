## This template may be used to generate an email message that can be sent to
## a user (and optionally a predefined set of server administrators) when their
## account is created in the server by a Delegated Administrator.
##
## Copy this file to the config/account-status-notification-email-templates
## directory of PingDirectory. See the README.txt file in that directory for
## a thorough description of the template file format and the variables and
## directives that can be used to customize its content.


## IMPORTANT: Uncomment the following line and change the URL to the
## Profile Management Endpoint of your PingFederate Local Identity Profile.
##
##set($profile_management_url = "https://pf.example.com:9031/pf/idprofile.ping?LocalIdentityProfileID=6erQUrLapZ01ITU7")


## Populate the values of any other variables that will appear in the body of
## the email message.
#getAttributeValue($account_entry, "uid", "username")
#getNotificationPropertyValue("new-generated-password", "generated_password")
#getNotificationPropertyValue("new-password", "new_password")
#getNotificationPropertyValue("must-change-password", "must_change_password")
#getNotificationPropertyValue("maximum-password-reset-age", "maximum_password_reset_age")

#if($generated_password)
  #set ($password = $generated_password)
#elseif($new_password)
  #set ($password = $new_password)
#end


----- BEGIN HEADERS -----

## Pull in a template file that will set the value of a number of header fields
## that will be shared across all types of account status notifications.
#parse("common-header-fields.vm")

## The subject for the generated email message.
#set($subject = "Your account has been created")
SUBJECT: $subject



----- BEGIN PLAIN-TEXT BODY -----

## Pull in a template file that can provide text at the top of the plain-text
## body for all types of account status notifications.
#parse("common-plain-text-body-header.vm")

#if($password)
Your account has been created with a username of $username and a password of $password.
#else
Your account has been created with a username of $username.
#end

#if($profile_management_url)
Manage your profile:
$profile_management_url
#end

#if($must_change_password == "true")

#if($maximum_password_reset_age)
You will be required to choose a new password the first time you log in. You must do so within the next $maximum_password_reset_age or your account will be locked again.
#else
You will be required to choose a new password the first time you log in.
#end
#end

## Pull in a template file that can provide text at the bottom of the
## plain-text body for all types of account status notifications.
#parse("common-plain-text-body-footer.vm")


----- BEGIN HTML BODY -----

<html>
  <head>
    <title>$subject</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  </head>

  <body>
## Pull in a template file that can provide styling and text at the top of the
## HTML-formatted body for all types of account status notifications.
#parse("common-html-body-header.vm")

    <p>
#if($password)
      Your account has been created with a username of $username and a password of $password.
#else
      Your account has been created with a username of $username.
#end
    </p>

#if($profile_management_url)
    <p>
      <a href="$profile_management_url">Manage your profile</a>
    </p>
#end

#if($must_change_password == "true")
    <p>
#if($maximum_password_reset_age)
      You will be required to choose a new password the first time you log in. You must do so within the next $maximum_password_reset_age or your account will be locked again.
#else
      You will be required to choose a new password the first time you log in.
#end
    </p>
#end

## Pull in a template file that can provide styling and text at the bottom of
## the HTML-formatted body for all types of account status notifications.
#parse("common-html-body-footer.vm")
  </body>
</html>

## Pull in a template file that can provide any attachments that be used for
## all types of account status notifications.
#parse("common-attachments.vm")
